<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Quản lý Người dùng</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="AdminUser.css">
</head>

<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="text-center mb-4">
            <img src="https://github.com/THQuis/SWP391_Group5/blob/main/Frontend/image/logo.png?raw=true" alt="Logo">
        </div>
        <a href="#"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
        <a href="AdminUser.html"><i class="fas fa-users"></i> Quản lý người dùng</a>
        <a href="#"><i class="fas fa-box"></i> Gói thành viên</a>
        <a href="#"><i class="fas fa-blog"></i> Quản lý blog</a>
        <a href="#"><i class="fas fa-medal"></i> Thành tích - Huy hiệu</a>
        <a href="#"><i class="fas fa-bell"></i> Thông báo</a>
    </div>

    <!-- Main Content -->
    <div>
        <!-- Navbar -->
        <div class="navbar">
            <button class="btn btn-outline-secondary" id="toggleSidebar"><i class="fas fa-bars"></i></button>
            <div class="profile">
                <button class="btn btn-outline-secondary me-2"><i class="fas fa-bell"></i></button>
                <a href="home2.html"><img src="https://github.com/THQuis/SWP391_Group5/blob/main/Frontend/image/home.png?raw=true" alt="Profile" class="rounded-circle" style="width: 40px;"></a>
            </div>
        </div>
        <!-- Content Area -->
        <div class="content" id="content">
            <h2>Quản lý Người dùng</h2>
            <div class="table-container">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="d-flex">
                        <input type="text" class="form-control me-2" placeholder="Tìm kiếm người dùng" id="searchUser">
                        <select class="form-select" id="filterRole">
                            <option value="">Tất cả vai trò</option>
                            <option value="Admin">Admin</option>
                            <option value="Member">Member</option>
                            <option value="Coach">Coach</option>
                        </select>
                    </div>
                    <!--<a href="AdminAddUser.html" class="btn btn-primary">Thêm Người dùng</a>  -->
                    <!-- Nút mở popup -->
<button class="btn btn-primary mb-3" onclick="showAddUserPopup()">
  <i class="fas fa-user-plus"></i> Thêm Người dùng
</button>
                </div>
                <table class="table table-bordered">
                    <thead class="table-light">
                        <tr>
                            <th>ID</th>
                            <th>Tên</th>
                            <th>Email</th>
                            <th>Gói thành viên</th>
                            <th>Trạng thái</th>
                            <th>Ngày đăng ký</th>
                            <th>Vai trò</th>
                            <th>Hành động</th>
                        </tr>
                    </thead>
                    <tbody id="userTable">
                        <tr>
                            <td>1</td>
                            <td>Nguyễn Văn A</td>
                            <td>nguyenvana@gmail.com</td>
                            <td>Premium</td>
                            <td>Hoạt động</td>
                            <td>2023-01-15</td>
                            <td>Admin</td>
                            <td>
                                <button class="btn btn-sm btn-warning" onclick="editRow(this)">Sửa</button>
                            </td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Trần Thị B</td>
                            <td>tranthib@gmail.com</td>
                            <td>Standard</td>
                            <td>Không hoạt động</td>
                            <td>2022-12-01</td>
                            <td>Người dùng</td>
                            <td>
                                <button class="btn btn-sm btn-warning" onclick="editRow(this)">Sửa</button>
                                <button class="btn btn-sm btn-danger" onclick="deleteRow(this)">Xóa</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!--hộp nổi nhỏ cho add useruser-->
            

<!-- Hộp nổi thêm người dùng -->
<div class="add-user-popup-overlay" id="addUserPopup">
  <div class="add-user-popup">
    <div class="popup-header">
      <span>Thêm người dùng</span>
      <button onclick="hideAddUserPopup()">×</button>
    </div>
    <form id="addUserForm">
      <div class="popup-body">
        <div class="mb-2">
          <label>Họ và tên</label>
          <input type="text" class="form-control popup-input" id="fullName" required />
        </div>
        <div class="mb-2">
          <label>Email</label>
          <input type="email" class="form-control popup-input" id="email" required />
        </div>
        <div class="mb-2">
          <label>Vai trò</label>
          <select class="form-select popup-input" id="role" required>
            <option value="">Chọn vai trò</option>
            <option value="Admin">Admin</option>
            <option value="Member">Member</option>
            <option value="Coach">Coach</option>
          </select>
        </div>
        <div class="mb-2">
          <label>Mật khẩu</label>
          <input type="password" class="form-control popup-input" id="password" required />
        </div>
        <div class="mb-3">
          <label>Xác nhận mật khẩu</label>
          <input type="password" class="form-control popup-input" id="confirmPassword" required />
        </div>
      </div>
      <div class="popup-footer">
        <span id="saveMessage" class="text-success me-auto" style="display:none;">✔ Đã lưu thành công!</span>
        <button type="button" class="btn btn-secondary" onclick="hideAddUserPopup()">Đóng</button>
        <button type="submit" class="btn btn-success">Lưu</button>
      </div>
    </form>
  </div>
</div>


        </div>
    </div>

    <script>

        const toggleSidebar = document.getElementById('toggleSidebar');
        const sidebar = document.getElementById('sidebar');
        const content = document.getElementById('content');

        toggleSidebar.addEventListener('click', () => {
            sidebar.classList.toggle('active');
            content.classList.toggle('active');
        });

        function editRow(button) {
            const row = button.closest('tr');
            const cells = row.querySelectorAll('td');

            const memberPackageCell = cells[3];
            const currentPackage = memberPackageCell.textContent.trim();
            memberPackageCell.innerHTML = `
                <select class="form-select">
                    <option value="Premium" ${currentPackage === 'Premium' ? 'selected' : ''}>Premium</option>
                    <option value="Standard" ${currentPackage === 'Standard' ? 'selected' : ''}>Standard</option>
                    <option value="Basic" ${currentPackage === 'Basic' ? 'selected' : ''}>Basic</option>
                </select>
            `;

            const statusCell = cells[4];
            const currentStatus = statusCell.textContent.trim();
            statusCell.innerHTML = `
                <select class="form-select">
                    <option value="Hoạt động" ${currentStatus === 'Hoạt động' ? 'selected' : ''}>Hoạt động</option>
                    <option value="Không hoạt động" ${currentStatus === 'Không hoạt động' ? 'selected' : ''}>Không hoạt động</option>
                </select>
            `;

            const roleCell = cells[6];
            const currentRole = roleCell.textContent.trim();
            roleCell.innerHTML = `
                <select class="form-select">
                    <option value="Admin" ${currentRole === 'Admin' ? 'selected' : ''}>Admin</option>
                    <option value="Member" ${currentRole === 'Member' ? 'selected' : ''}>Member</option>
                    <option value="Coach" ${currentRole === 'Coach' ? 'selected' : ''}>Coach</option>
                </select>
            `;

            button.textContent = 'Lưu';
            button.classList.remove('btn-warning');
            button.classList.add('btn-success');
            button.setAttribute('onclick', 'saveRow(this)');
        }

        function saveRow(button) {
            const row = button.closest('tr');
            const cells = row.querySelectorAll('td');

            const memberPackageCell = cells[3];
            const selectedPackage = memberPackageCell.querySelector('select').value;
            memberPackageCell.textContent = selectedPackage;

            const statusCell = cells[4];
            const selectedStatus = statusCell.querySelector('select').value;
            statusCell.textContent = selectedStatus;

            const roleCell = cells[6];
            const selectedRole = roleCell.querySelector('select').value;
            roleCell.textContent = selectedRole;

            button.textContent = 'Sửa';
            button.classList.remove('btn-success');
            button.classList.add('btn-warning');
            button.setAttribute('onclick', 'editRow(this)');
        }
        function deleteRow(button) {
            const row = button.closest('tr');
            row.remove();
            // Nếu cần thêm xử lý khác (ví dụ xóa dữ liệu từ server), thêm tại đây.
        }
        // thêm hộp nhỏ cho add user
        function showAddUserPopup() {
  document.getElementById("addUserPopup").style.display = "flex";
}

function hideAddUserPopup() {
  document.getElementById("addUserPopup").style.display = "none";
}

document.getElementById("addUserForm").addEventListener("submit", function (e) {
  e.preventDefault();

  const name = document.getElementById("fullName").value;
  const email = document.getElementById("email").value;
  const role = document.getElementById("role").value;
  const password = document.getElementById("password").value;
  const confirm = document.getElementById("confirmPassword").value;

  if (password !== confirm) {
    alert("Mật khẩu xác nhận không khớp!");
    return;
  }

  const newRow = `
    <tr>
      <td>${document.querySelectorAll("#userTable tr").length + 1}</td>
      <td>${name}</td>
      <td>${email}</td>
      <td>Standard</td>
      <td>Hoạt động</td>
      <td>${new Date().toISOString().slice(0, 10)}</td>
      <td>${role}</td>
      <td>
        <button class="btn btn-sm btn-warning" onclick="editRow(this)">Sửa</button>
        <button class="btn btn-sm btn-danger" onclick="deleteRow(this)">Xóa</button>
      </td>
    </tr>
  `;

  document.getElementById("userTable").insertAdjacentHTML("beforeend", newRow);

  const msg = document.getElementById("saveMessage");
  msg.style.display = "inline-block";

  setTimeout(() => {
    msg.style.display = "none";
    hideAddUserPopup();
    document.getElementById("addUserForm").reset();
  }, 1000);
});

    </script>
</body>

</html>